{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import{getAllApplications,getApplicationsByUserId}from'../services/api';import'../styles/Table.css';import'../styles/Form.css';import'../styles/Dashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const formatStatus=status=>{if(!status)return'N/A';return status.toLowerCase().replace(/_/g,' ').replace(/(?: |\\b)(\\w)/g,char=>char.toUpperCase());};const STAGES=['DRAFTING_AND_FILING','FORMALITY_EXAMINATION','APPLICATION_PUBLICATION','SUBSTANTIVE_EXAMINATION_REQUEST','SUBSTANTIVE_EXAMINATION','FEE_PAYMENT_AND_GRANT'];const ApplicationList=_ref=>{let{user}=_ref;const[applications,setApplications]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[searchTerm,setSearchTerm]=useState('');const[stageFilter,setStageFilter]=useState('');const isUser=user&&user.role==='USER';const pageTitle=isUser?'My Applications':'Review Applications';useEffect(()=>{const fetchApplications=async()=>{try{const response=isUser?await getApplicationsByUserId(user.id):await getAllApplications();setApplications(response.data);}catch(err){setError('Failed to fetch applications.');}finally{setLoading(false);}};fetchApplications();},[user,isUser]);const getAction=app=>{if(app.rejectionReason){return/*#__PURE__*/_jsx(Link,{to:\"/applications/\".concat(app.id,\"/amend\"),className:\"action-button button-warning\",children:\"Update\"});}switch(app.status){case'SUBSTANTIVE_EXAMINATION_REQUEST':return/*#__PURE__*/_jsx(Link,{to:\"/applications/\".concat(app.id),className:\"action-button\",children:\"Send Request\"});case'FEE_PAYMENT_AND_GRANT':return/*#__PURE__*/_jsx(Link,{to:\"/applications/\".concat(app.id,\"/payment\"),className:\"action-button button-success\",children:\"Pay Fee\"});default:return/*#__PURE__*/_jsx(Link,{to:\"/applications/\".concat(app.id),className:\"action-button\",children:\"View\"});}};const filteredApplications=applications.filter(app=>{const titleMatch=app.title.toLowerCase().includes(searchTerm.toLowerCase());const stageMatch=stageFilter?app.status===stageFilter:true;return titleMatch&&stageMatch;});if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading applications...\"});if(error)return/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error});return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:pageTitle}),/*#__PURE__*/_jsx(Link,{to:\"/applications/new\",className:\"button-primary\",children:\"New Application\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filters-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search by title...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"filter-input\"}),/*#__PURE__*/_jsxs(\"select\",{value:stageFilter,onChange:e=>setStageFilter(e.target.value),className:\"filter-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Stages\"}),STAGES.map(stage=>/*#__PURE__*/_jsx(\"option\",{value:stage,children:formatStatus(stage)},stage))]})]}),filteredApplications.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No applications found.\"}):/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Title\"}),!isUser&&/*#__PURE__*/_jsx(\"th\",{children:\"Submitted By\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Current Stage\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredApplications.map(app=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:app.id}),/*#__PURE__*/_jsx(\"td\",{children:app.title}),!isUser&&/*#__PURE__*/_jsx(\"td\",{children:app.submittedByUsername}),/*#__PURE__*/_jsx(\"td\",{children:formatStatus(app.status)}),/*#__PURE__*/_jsx(\"td\",{className:app.rejectionReason?'status-rejected':'status-pending',children:app.rejectionReason?'Amendment Required':'Processing'}),/*#__PURE__*/_jsx(\"td\",{children:getAction(app)})]},app.id))})]})]});};export default ApplicationList;","map":{"version":3,"names":["React","useState","useEffect","Link","getAllApplications","getApplicationsByUserId","jsx","_jsx","jsxs","_jsxs","formatStatus","status","toLowerCase","replace","char","toUpperCase","STAGES","ApplicationList","_ref","user","applications","setApplications","loading","setLoading","error","setError","searchTerm","setSearchTerm","stageFilter","setStageFilter","isUser","role","pageTitle","fetchApplications","response","id","data","err","getAction","app","rejectionReason","to","concat","className","children","filteredApplications","filter","titleMatch","title","includes","stageMatch","style","color","type","placeholder","value","onChange","e","target","map","stage","length","submittedByUsername"],"sources":["C:/Users/Admin/OneDrive/Máy tính/Báo cáo project 1/SHTT_NEW/ip-management-frontend/src/components/ApplicationList.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { getAllApplications, getApplicationsByUserId } from '../services/api';\r\nimport '../styles/Table.css';\r\nimport '../styles/Form.css';\r\nimport '../styles/Dashboard.css';\r\n\r\nconst formatStatus = (status) => {\r\n  if (!status) return 'N/A';\r\n  return status\r\n    .toLowerCase()\r\n    .replace(/_/g, ' ')\r\n    .replace(/(?: |\\b)(\\w)/g, (char) => char.toUpperCase());\r\n};\r\n\r\nconst STAGES = [\r\n  'DRAFTING_AND_FILING',\r\n  'FORMALITY_EXAMINATION',\r\n  'APPLICATION_PUBLICATION',\r\n  'SUBSTANTIVE_EXAMINATION_REQUEST',\r\n  'SUBSTANTIVE_EXAMINATION',\r\n  'FEE_PAYMENT_AND_GRANT',\r\n];\r\n\r\nconst ApplicationList = ({ user }) => {\r\n  const [applications, setApplications] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [stageFilter, setStageFilter] = useState('');\r\n\r\n  const isUser = user && user.role === 'USER';\r\n  const pageTitle = isUser ? 'My Applications' : 'Review Applications';\r\n\r\n  useEffect(() => {\r\n    const fetchApplications = async () => {\r\n      try {\r\n        const response = isUser ? await getApplicationsByUserId(user.id) : await getAllApplications();\r\n        setApplications(response.data);\r\n      } catch (err) {\r\n        setError('Failed to fetch applications.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchApplications();\r\n  }, [user, isUser]);\r\n\r\n  const getAction = (app) => {\r\n    if (app.rejectionReason) {\r\n      return <Link to={`/applications/${app.id}/amend`} className=\"action-button button-warning\">Update</Link>;\r\n    }\r\n    switch (app.status) {\r\n      case 'SUBSTANTIVE_EXAMINATION_REQUEST':\r\n        return <Link to={`/applications/${app.id}`} className=\"action-button\">Send Request</Link>;\r\n      case 'FEE_PAYMENT_AND_GRANT':\r\n        return <Link to={`/applications/${app.id}/payment`} className=\"action-button button-success\">Pay Fee</Link>;\r\n      default:\r\n        return <Link to={`/applications/${app.id}`} className=\"action-button\">View</Link>;\r\n    }\r\n  };\r\n\r\n  const filteredApplications = applications.filter(app => {\r\n    const titleMatch = app.title.toLowerCase().includes(searchTerm.toLowerCase());\r\n    const stageMatch = stageFilter ? app.status === stageFilter : true;\r\n    return titleMatch && stageMatch;\r\n  });\r\n\r\n  if (loading) return <p>Loading applications...</p>;\r\n  if (error) return <p style={{ color: 'red' }}>{error}</p>;\r\n\r\n  return (\r\n    <div className=\"dashboard-container\">\r\n      <div className=\"dashboard-header\">\r\n        <h2>{pageTitle}</h2>\r\n        <Link to=\"/applications/new\" className=\"button-primary\">New Application</Link>\r\n      </div>\r\n      \r\n      <div className=\"filters-container\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search by title...\"\r\n          value={searchTerm}\r\n          onChange={(e) => setSearchTerm(e.target.value)}\r\n          className=\"filter-input\"\r\n        />\r\n        <select value={stageFilter} onChange={(e) => setStageFilter(e.target.value)} className=\"filter-select\">\r\n          <option value=\"\">All Stages</option>\r\n          {STAGES.map(stage => <option key={stage} value={stage}>{formatStatus(stage)}</option>)}\r\n        </select>\r\n      </div>\r\n\r\n      {filteredApplications.length === 0 ? (\r\n        <p>No applications found.</p>\r\n      ) : (\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>ID</th>\r\n              <th>Title</th>\r\n              {!isUser && <th>Submitted By</th>}\r\n              <th>Current Stage</th>\r\n              <th>Status</th>\r\n              <th>Action</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredApplications.map((app) => (\r\n              <tr key={app.id}>\r\n                <td>{app.id}</td>\r\n                <td>{app.title}</td>\r\n                {!isUser && <td>{app.submittedByUsername}</td>}\r\n                <td>{formatStatus(app.status)}</td>\r\n                <td className={app.rejectionReason ? 'status-rejected' : 'status-pending'}>\r\n                  {app.rejectionReason ? 'Amendment Required' : 'Processing'}\r\n                </td>\r\n                <td>{getAction(app)}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ApplicationList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}