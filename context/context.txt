I. MÃ” HÃŒNH Tá»”NG QUAN (STATE MACHINE â€“ MÃY TRáº NG THÃI)

Thay vÃ¬ mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n (Ná»™p â†’ Duyá»‡t), há»‡ thá»‘ng Ä‘Æ°á»£c nÃ¢ng cáº¥p theo quy trÃ¬nh chuáº©n cá»§a Cá»¥c SHTT.

Má»—i há»“ sÆ¡ luÃ´n náº±m Ä‘Ãºng má»™t Giai Ä‘oáº¡n (Stage) nháº¥t Ä‘á»‹nh.
NghiÃªm cáº¥m nháº£y bÆ°á»›c: BÆ°á»›c trÆ°á»›c hoÃ n táº¥t â†’ há»‡ thá»‘ng má»›i má»Ÿ khÃ³a bÆ°á»›c sau.

Danh sÃ¡ch Giai Ä‘oáº¡n ChÃ­nh
Giai Ä‘oáº¡n	TÃªn	Ai thá»±c hiá»‡n?	Diá»…n giáº£i
0	DRAFT_SUBMISSION	User	Soáº¡n tháº£o & ná»™p Ä‘Æ¡n
1	FORMALITY_EXAMINATION	Admin	Tháº©m Ä‘á»‹nh hÃ¬nh thá»©c
â€“	FORMALITY_AMENDMENT_REQUIRED	User	User sá»­a Ä‘á»•i theo yÃªu cáº§u
2	PUBLICATION	Há»‡ thá»‘ng/Admin	CÃ´ng bá»‘ Ä‘Æ¡n
3	REQUEST_SUBSTANTIVE_EXAMINATION	User	User yÃªu cáº§u tháº©m Ä‘á»‹nh ná»™i dung
4	SUBSTANTIVE_EXAMINATION	Admin	Tháº©m Ä‘á»‹nh ná»™i dung (Novelty â€“ Inventive Step â€“ Industrial Applicability)
â€“	SUBSTANTIVE_AMENDMENT_REQUIRED	User	Sá»­a Ä‘á»•i/giáº£i trÃ¬nh
â€“	SUBSTANTIVE_REJECTED	Admin	Tá»« chá»‘i Ä‘Æ¡n
5	FEE_PAYMENT_AND_GRANT	User/Admin	Ná»™p lá»‡ phÃ­ & cáº¥p báº±ng
Luá»“ng chuyá»ƒn tráº¡ng thÃ¡i (CHUáº¨N & Cá»¨NG)
DRAFT_SUBMISSION 
    -> FORMALITY_EXAMINATION
        -> FORMALITY_AMENDMENT_REQUIRED -> FORMALITY_EXAMINATION
        -> (OK) â†’ PUBLICATION
            -> REQUEST_SUBSTANTIVE_EXAMINATION
                -> SUBSTANTIVE_EXAMINATION
                    -> SUBSTANTIVE_AMENDMENT_REQUIRED -> SUBSTANTIVE_EXAMINATION
                    -> (OK) â†’ FEE_PAYMENT_AND_GRANT
                    -> (NOT OK) â†’ SUBSTANTIVE_REJECTED

II. MÃ” Táº¢ NGHIá»†P Vá»¤ THEO GIAI ÄOáº N (BUSINESS WORKFLOW)
Giai Ä‘oáº¡n 0 â€“ DRAFT_SUBMISSION

User nháº­p thÃ´ng tin, Ä‘Ã­nh kÃ¨m tÃ i liá»‡u.

Chá»n Ä‘á»‘i tÆ°á»£ng báº£o há»™: PRODUCT hoáº·c PROCESS.

Khi nháº¥n â€œNá»™p Ä‘Æ¡nâ€ â†’ chuyá»ƒn sang FORMALITY_EXAMINATION.

Giai Ä‘oáº¡n 1 â€“ FORMALITY_EXAMINATION

Admin kiá»ƒm tra:

HÃ¬nh thá»©c Ä‘Æ¡n

Tá» khai

PhÃ­

HÃ¬nh váº½

TÃ i liá»‡u tá»‘i thiá»ƒu

Quyáº¿t Ä‘á»‹nh:

âœ” Cháº¥p nháº­n Ä‘Æ¡n há»£p lá»‡ â†’ sang PUBLICATION

ğŸŸ  YÃªu cáº§u sá»­a Ä‘á»•i â†’ FORMALITY_AMENDMENT_REQUIRED (User sá»­a â†’ Ná»™p láº¡i â†’ quay láº¡i FORMALITY_EXAMINATION)

âŒ Tá»« chá»‘i Ä‘Æ¡n (Káº¿t thÃºc)

Giai Ä‘oáº¡n 2 â€“ PUBLICATION

Há»‡ thá»‘ng cÃ´ng bá»‘ Ä‘Æ¡n lÃªn CÃ´ng bÃ¡o.

Sau thá»i gian luáº­t Ä‘á»‹nh â†’ má»Ÿ khÃ³a giai Ä‘oáº¡n 3.

Giai Ä‘oáº¡n 3 â€“ REQUEST_SUBSTANTIVE_EXAMINATION

User pháº£i chá»§ Ä‘á»™ng gá»­i yÃªu cáº§u tháº©m Ä‘á»‹nh ná»™i dung (hoáº·c há»‡ thá»‘ng tá»± gá»­i theo cáº¥u hÃ¬nh).

Khi xÃ¡c nháº­n â†’ sang SUBSTANTIVE_EXAMINATION.

Giai Ä‘oáº¡n 4 â€“ SUBSTANTIVE_EXAMINATION

Admin thá»±c hiá»‡n Ä‘Ã¡nh giÃ¡:

TÃ­nh má»›i

TrÃ¬nh Ä‘á»™ sÃ¡ng táº¡o

Kháº£ nÄƒng Ã¡p dá»¥ng CN

Tra cá»©u thÃ´ng tin sÃ¡ng cháº¿ (Search Report)

Quyáº¿t Ä‘á»‹nh:

âœ” Dá»± Ä‘á»‹nh cáº¥p báº±ng â†’ Sang FEE_PAYMENT_AND_GRANT

ğŸŸ  Thiáº¿u sÃ³t ná»™i dung, yÃªu cáº§u giáº£i trÃ¬nh/sá»­a claims â†’ SUBSTANTIVE_AMENDMENT_REQUIRED â†’ User sá»­a â†’ Quay láº¡i SUBSTANTIVE_EXAMINATION

âŒ Tá»« chá»‘i â†’ SUBSTANTIVE_REJECTED

Giai Ä‘oáº¡n 5 â€“ FEE_PAYMENT_AND_GRANT

User Ä‘Ã³ng lá»‡ phÃ­.
Admin xÃ¡c nháº­n â†’ Cáº¥p báº±ng â†’ HoÃ n táº¥t quy trÃ¬nh.

III. THIáº¾T Káº¾ CÆ  Sá» Dá»® LIá»†U (DATABASE DESIGN)
1. Báº£ng patent_types (Chuáº©n hÃ³a)

invention (SÃ¡ng cháº¿)

utility_solution (Giáº£i phÃ¡p há»¯u Ã­ch)

2. Báº£ng submissions (Cá»‘t lÃµi â€“ Äiá»u khiá»ƒn state machine)

CÃ¡c trÆ°á»ng thÃªm má»›i quan trá»ng:

ALTER TABLE public.submissions
ADD COLUMN current_stage VARCHAR(50) NOT NULL DEFAULT 'DRAFT_SUBMISSION',
ADD COLUMN status VARCHAR(50) DEFAULT 'PENDING',
ADD COLUMN is_locked BOOLEAN DEFAULT true;

3. Báº£ng patent_details (ThÃ´ng tin Ä‘áº·c thÃ¹ SÃ¡ng cháº¿/GPHI)

âœ” PhÃ¢n tÃ¡ch khá»i submissions
âœ” LÆ°u trá»¯ ná»™i dung theo luáº­t: MÃ´ táº£ â€“ HÃ¬nh váº½ â€“ Claims â€“ Bá»‘i cáº£nh ká»¹ thuáº­t

<the SQL is already good, giá»¯ nguyÃªn>

4. Báº£ng application_timeline (Äiá»u khiá»ƒn Workflow + Audit Trail)

Äiá»ƒm quan trá»ng:
Má»—i giai Ä‘oáº¡n sáº½ cÃ³ Ã­t nháº¥t má»™t dÃ²ng, theo dÃµi Ä‘áº§y Ä‘á»§: start, end, status, note, processor.

<the SQL is already good, giá»¯ nguyÃªn>

IV. LOGIC BACKEND (STATE MACHINE ENGINE)
HÃ m chuyá»ƒn giai Ä‘oáº¡n (chuáº©n nháº¥t Ä‘á»ƒ AI sinh code)
public void promoteToNextStage(UUID submissionId) {
    Submission sub = repo.findById(submissionId);

    switch (sub.getCurrentStage()) {

        case "FORMALITY_EXAMINATION":
            createTimeline(sub, "PUBLICATION");
            sub.setCurrentStage("PUBLICATION");
            break;

        case "PUBLICATION":
            createTimeline(sub, "REQUEST_SUBSTANTIVE_EXAMINATION");
            sub.setCurrentStage("REQUEST_SUBSTANTIVE_EXAMINATION");
            break;

        case "REQUEST_SUBSTANTIVE_EXAMINATION":
            createTimeline(sub, "SUBSTANTIVE_EXAMINATION");
            sub.setCurrentStage("SUBSTANTIVE_EXAMINATION");
            break;

        case "SUBSTANTIVE_EXAMINATION":
            createTimeline(sub, "FEE_PAYMENT_AND_GRANT");
            sub.setCurrentStage("FEE_PAYMENT_AND_GRANT");
            break;
    }

    repo.save(sub);
}


KhÃ´ng cho phÃ©p chuyá»ƒn stage khi chÆ°a hoÃ n táº¥t stage hiá»‡n táº¡i.

LOGIC KIá»‚M SOÃT TRUY Cáº¬P

API tráº£ vá» cho frontend:

{
  "id": "123",
  "title": "MÃ¡y cáº¯t cá» tá»± Ä‘á»™ng",
  "currentStage": "FORMALITY_EXAMINATION",
  "status": "REQUIRE_AMENDMENT",
  "isLocked": false,
  "actionsAllowed": [
      "UPDATE_DOCUMENT",
      "RE_SUBMIT"
  ]
}

V. UI/UX â€“ MÃ” Táº¢ Äáº¦Y Äá»¦
1. Giao diá»‡n User
Dashboard

MÃ£ Ä‘Æ¡n

TÃªn sÃ¡ng cháº¿

Loáº¡i hÃ¬nh

Giai Ä‘oáº¡n

Tráº¡ng thÃ¡i

HÃ nh Ä‘á»™ng nhanh (Sá»­a, Gá»­i yÃªu cáº§u TÄND, Thanh toÃ¡nâ€¦)

Chi tiáº¿t há»“ sÆ¡

âœ” Stepper 6 bÆ°á»›c
âœ” Alert Box Ä‘á»™ng
âœ” Tabs: Info â€“ Documents â€“ Timeline

2. Giao diá»‡n Reviewer
WorkQueue

Lá»c theo giai Ä‘oáº¡n

Háº¡n xá»­ lÃ½

Workspace (2 cá»™t)

TrÃ¡i: Ná»™i dung/PDF

Pháº£i: Checklist + Quyáº¿t Ä‘á»‹nh

VI. MÃ” Táº¢ NGHIá»†P Vá»¤ CHUáº¨N (DEMO SCENARIO)

VÃ­ dá»¥ xá»­ lÃ½ sá»­a Ä‘á»•i hÃ¬nh thá»©c (Stage 1):

Reviewer yÃªu cáº§u sá»­a
â†’ tráº¡ng thÃ¡i chuyá»ƒn thÃ nh FORMALITY_AMENDMENT_REQUIRED

User sá»­a â†’ Ná»™p láº¡i
â†’ quay láº¡i FORMALITY_EXAMINATION

Reviewer duyá»‡t
â†’ Sang PUBLICATION

âœ… Káº¾T LUáº¬N

ÄÃ¢y lÃ  báº£n context hoÃ n chá»‰nh â€“ sáº¡ch â€“ logic â€“ chuyÃªn nghiá»‡p.
Äá»§ chuáº©n Ä‘á»ƒ:

Sinh code backend (state machine, API, service, DTO)

Sinh code frontend (stepper, button logic)

Sinh database schema

Sinh tÃ i liá»‡u cho tháº§y, doanh nghiá»‡p



